#:schema node_modules/wrangler/config-schema.json
name = "hexa-app"
main = ".worker-next/index.mjs"
workers_dev = false
routes = [
  { pattern = "app.hexa.im", custom_domain = true }
]
upload_source_maps = true
compatibility_date = "2024-09-26"
compatibility_flags = ["nodejs_compat"]

# Minification helps to keep the Worker bundle size down and improve start up time.
minify = true

# Use the new Workers + Assets to host the static frontend files
assets = { directory = ".worker-next/assets", binding = "ASSETS" }

# wrangler.toml (wrangler v3.79.0^)
[observability]
enabled = true
head_sampling_rate = 1

[[d1_databases]]
binding = "DB"
database_name = "hexa"
database_id = "ce720dbc-f1ce-4d3b-9348-a7d1cb6bbe43"
migrations_dir = "./drizzle/migrations"

[[kv_namespaces]]
binding = "REDIRECT"
id = "1eed1bf2d8ae4aa9a112121be24ad5d7"

# =================== Staging ===================
[env.staging]
name="hexa-app-xyz"
workers_dev = true
routes = [
  { pattern = "app.ml.kg", custom_domain = true },
  { pattern = "www.ml.kg", custom_domain = true },
  { pattern = "admin.ml.kg", custom_domain = true },
  { pattern = "ml.kg", custom_domain = true }
]

[[env.staging.d1_databases]]
binding = "DB"
database_name = "hexa-xyz"
database_id = "8540e0e2-15ee-44f6-82ec-64584e8331a8"
migrations_dir = "./drizzle/migrations"


[[env.staging.kv_namespaces]]
binding = "REDIRECT"
id = "082a86f93ac54912af21bdf8ae170ade"